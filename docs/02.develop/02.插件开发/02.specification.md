---
title: æ’ä»¶è§„èŒƒ
permalink: /wiki/shadowviewer/plugin/specification
article: false
comment: true
author: 
  name: kitUIN
  link: https://github.com/kitUIN
date: 2023-11-02 15:23:49
---

## å‰è¨€ğŸ“ƒ

ç”±äºå¾®è½¯å¯¹äº`WindowsApps`æ–‡ä»¶å¤¹çš„é™åˆ¶,å¯¼è‡´æ‰“åŒ…ç‰ˆåº”ç”¨(appx/msixæ‰“åŒ…ç‰ˆ)æ— æ³•ä¿®æ”¹è‡ªèº«å®‰è£…æ–‡ä»¶å¤¹  
è¿™å¯¹äºæ’ä»¶ç³»ç»Ÿçš„`ms-appx://`è¯†åˆ«å­˜åœ¨é‡å¤§å½±å“  
æ‰€ä»¥è¯¥æ’ä»¶æ¨¡å¼ä½ éœ€è¦éµå®ˆä¸€äº›è¦æ±‚æ¥ä½¿å¾—æ’ä»¶æ­£å¸¸è¿è¡Œ

ä½ éœ€è¦éµå¾ªä»¥ä¸‹å››ä¸ªè¦æ±‚

- [Page æˆ– UserControl](https://github.com/kitUIN/ShadowViewer/wiki/%E6%8F%92%E4%BB%B6%E8%A7%84%E8%8C%83#page%E6%88%96usercontrol)
- [Xaml èµ„æºå­—å…¸](https://github.com/kitUIN/ShadowViewer/wiki/%E6%8F%92%E4%BB%B6%E8%A7%84%E8%8C%83#xaml-%E8%B5%84%E6%BA%90%E5%AD%97%E5%85%B8)
- [Assets èµ„æºæ–‡ä»¶](https://github.com/kitUIN/ShadowViewer/wiki/%E6%8F%92%E4%BB%B6%E8%A7%84%E8%8C%83#assets-%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6)
- [Resw æœ¬åœ°åŒ–](https://github.com/kitUIN/ShadowViewer/wiki/%E6%8F%92%E4%BB%B6%E8%A7%84%E8%8C%83#resw-%E6%9C%AC%E5%9C%B0%E5%8C%96)
- [æ’ä»¶å…ƒæ•°æ®](https://github.com/kitUIN/ShadowViewer/wiki/%E6%8F%92%E4%BB%B6%E8%A7%84%E8%8C%83#pluginmetadata-%E6%8F%92%E4%BB%B6%E5%85%83%E6%95%B0%E6%8D%AE)

## Pageæˆ–UserControl

åˆ›å»ºæ–°çš„Pageæˆ–è€…ç”¨æˆ·æ§ä»¶çš„æ—¶å€™  
ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ„é€ å‡½æ•°  
(ä»¥`LoginTip`ä¸ºä¾‹å­)

```CSharp
public LoginTip()
{
    InitializeComponent();
}
```

ä½†æ˜¯åœ¨æ’ä»¶ä¸­`InitializeComponent()`æ— æ³•æ­£å¸¸åŠ è½½  
æ‰€ä»¥æˆ‘ä»¬è¦æ”¹ä¸º

```CSharp
using CustomExtensions.WinUI;
public LoginTip()
{
     this.LoadComponent(ref _contentLoaded);
}
```

è¿™æ ·å°±èƒ½æ­£å¸¸è¯†åˆ«æ’ä»¶çš„Xamlå†…å®¹äº†
âš ï¸è¯·æ³¨æ„,æ’ä»¶ä¸­çš„æ¯ä¸€ä¸ªPageæˆ–è€…UserControléƒ½è¦æ›´æ”¹ä¸ºè¿™ç§å½¢å¼,å¦åˆ™å°†æ— æ³•åŠ è½½

## Xaml èµ„æºå­—å…¸

ä¸€èˆ¬æ¥è¯´,æˆ‘ä»¬ä¼šå°†ä¸€äº›å¸¸ç”¨çš„`Color`,`Style`å¡åˆ°ä¸€ä¸ª`theme.xaml`ä¸­  
![u751pv.png](https://files.catbox.moe/u751pv.png)  
è¿™ä¸ª`theme.xaml`å†…éƒ¨æ˜¯`ResourceDictionary`  
æ­£å¸¸é¡¹ç›®ä¸­æˆ‘ä»¬éƒ½ä¼šå¡åˆ°`App.xaml`é‡Œ,ä½†æ˜¯æ’ä»¶æ˜¯æ²¡æœ‰`App.xaml`çš„,æ‰€ä»¥åœ¨`PluginBase`ç±»ä¸­å°±å®ç°äº†è¯¥åŠŸèƒ½

è¯·ç”¨ä½ è‡ªå·±çš„æ’ä»¶ä¸»ç±»(æ¯”å¦‚æˆ‘çš„æ˜¯`BikaPlugin`)å®ç°ä»¥ä¸‹æ–¹æ³•

```CSharp
public override IEnumerable<ResourceDictionary> ResourceDictionaries => new List<ResourceDictionary>
{
    new ResourceDictionary() { Source ="/Themes/BikaTheme.xaml".AssetUri<BikaPlugin>() }
};
```

è¿™æ ·ä¼šåœ¨æ’ä»¶åŠ è½½è¿›å…¥æœ¬ä½“çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆå¹¶åˆ°`App.xaml`

## Assets èµ„æºæ–‡ä»¶

é’ˆå¯¹Assetsæ–‡ä»¶å¤¹å†…çš„å›¾ç‰‡æˆ–è€…å…¶ä»–æ–‡ä»¶  
å°†åœ¨ä¸€èˆ¬WinUI3åº”ç”¨ä¸­é‡‡ç”¨çš„  

```xml
<Image Source="ms-appx:///Assets/Picacgs/picacomic_2.png" /> <!-- è¿™æ˜¯é”™è¯¯çš„ ->
```

â†“â†“æ”¹ä¸ºâ†“â†“

```xml
<Image 
  xmlns:ee="using:CustomExtensions.WinUI"
  Source="{x:Bind ee:WinUIExtensions.ImageSource('/Assets/Picacgs/picacomic_2.png')}" />
```

åœ¨è¿™é‡Œæˆ‘ä»¬å¼•å…¥äº†å‘½åç©ºé—´`CustomExtensions.WinUI`  
ç„¶åä½¿ç”¨é™æ€æ–¹æ³•`WinUIExtensions.ImageSource`å°†ç›¸å¯¹è·¯å¾„`/Assets/Picacgs/picacomic_2.png`ä¿®æ”¹ä¸ºç¨‹åºèƒ½å¤Ÿè¯†åˆ«çš„è·¯å¾„  
å¦‚æœæƒ³è¦çŸ¥é“è¯¦ç»†å†…å®¹,è¯·æŸ¥çœ‹æºç 

âš ï¸è¿™ä¸ªæ–¹æ³•åªèƒ½åœ¨ä½ è‡ªå·±çš„æ’ä»¶ç¨‹åºé›†ä¸­ä½¿ç”¨,å¦‚æœæƒ³ä¿®æ”¹ShadowVieweræœ¬ä½“æˆ–è€…å…¶ä»–ç¨‹åºé›†,è¯·ä¸è¦ä½¿ç”¨è¿™ä¸ªæ–¹æ³•

å¦‚æœä½ æƒ³ä½¿ç”¨ä»£ç :

```CSharp
using CustomExtensions.WinUI;
var image = new Image()
{
    Source = "/Assets/Picacgs/picacomic_2.png".ImageSource<BikaPlugin>(),
};
```

`BikaPlugin`å³ä¸ºä½ è‡ªå·±çš„æ’ä»¶ä¸»ç±»,ç»§æ‰¿è‡ª`PluginBase`

## Resw æœ¬åœ°åŒ–

![kmctor.png](https://files.catbox.moe/kmctor.png)

- åœ¨ä»£ç ä¸­è·å–æœ¬åœ°åŒ–å­—ç¬¦ä¸²

```CSharp
using CustomExtensions.WinUI;
public static string GetString(string key) 
{
    var resourceManager = ApplicationExtensionHost.GetResourceMapForAssembly();
    return resourceManager.GetValue(key).ValueAsString;
}
```

- åœ¨Xamlä¸­è·å–æœ¬åœ°åŒ–å­—ç¬¦ä¸²  

åœ¨è¿™é‡Œå»ºè®®ç»§æ‰¿`MarkupExtension`å®ç°ä¸€ä¸ªè‡ªå·±çš„æœ¬åœ°åŒ–ç±»(ä¾‹å­:[BikaLocaleExtension](https://github.com/kitUIN/ShadowViewer.Plugin.Bika/blob/master/ShadowViewer.Plugin.Bika/Extensions/BikaLocaleExtension.cs))  
ç„¶åå°±å¯ä»¥åœ¨Xamlæ–‡ä»¶ä¸­ä½¿ç”¨

```xml
<TextBlock 
   xmlns:ex="using:ShadowViewer.Plugin.Bika.Extensions"
   Text="{ex:BikaLocale Key=AboutDescription}" />
```

## PluginMetaData æ’ä»¶å…ƒæ•°æ®

æ’ä»¶å…ƒæ•°æ®æ˜¯æä¾›ç»™åº”ç”¨æœ¬ä½“è¯»å–çš„,æ‰€ä»¥å¯¹äºä»»ä½•æ’ä»¶æ¥è¯´éƒ½æ˜¯å¿…é¡»çš„  
æ’ä»¶å…ƒæ•°æ®åŒ…å«ä»¥ä¸‹å‡ é¡¹:

- æ’ä»¶ID(Id)
- æ’ä»¶åç§°(Name)
- æ’ä»¶ä»‹ç»(Description)
- æ’ä»¶ä½œè€…(Author)
- æ’ä»¶ç‰ˆæœ¬(Version)
- æ’ä»¶ä»“åº“åœ°å€(WebUri)
- æ’ä»¶å›¾æ ‡(Logo)
- æ”¯æŒçš„æ’ä»¶ç®¡ç†å™¨ç‰ˆæœ¬(MinVersion)
- æ”¯æŒçš„è¯­è¨€(Lang)
- ä¾èµ–çš„æ’ä»¶ID(Require)

ç¤ºä¾‹

```CSharp
[PluginMetaData("Bika",
    "å“”å’”æ¼«ç”»",
    "å“”å’”æ¼«ç”»é€‚é…å™¨",
    "kitUIN", "0.1.0",
    "https://github.com/kitUIN/ShadowViewer.Plugin.Bika/",
    "ms-appx:///Assets/Icons/logo.png",
    20230808, 
    new []{"Local"},
    new []{"zh-CN"}
    )]
public partial class BikaPlugin : PluginBase
```

### æ’ä»¶ID

å¤§å°å†™ä¸æ•æ„Ÿ,å»ºè®®ä¸ºè‹±æ–‡  
âš ï¸è¿™æ˜¯æ’ä»¶çš„å”¯ä¸€æ ‡è¯†ç¬¦,è¯·æ³¨æ„ä¸è¦ä¸åˆ«çš„æ’ä»¶é‡åˆäº†  
type:`string`

### æ’ä»¶åç§°

è¿™æ˜¯æ’ä»¶åœ¨åº”ç”¨ä¸­æ˜¾ç¤ºçš„åç§°  
type:`string`

### æ’ä»¶ä»‹ç»

è¿™æ˜¯æ’ä»¶åœ¨åº”ç”¨ä¸­æ˜¾ç¤ºçš„ä»‹ç»  
type:`string`

### æ’ä»¶ç‰ˆæœ¬

è¿™æ˜¯æ’ä»¶åœ¨åº”ç”¨ä¸­æ˜¾ç¤ºçš„ç‰ˆæœ¬  
type:`string`

### æ’ä»¶ä½œè€…

è¿™æ˜¯æ’ä»¶åœ¨åº”ç”¨ä¸­æ˜¾ç¤ºçš„ä½œè€…  
type:`string`

### æ’ä»¶ä»“åº“åœ°å€

è¿™æ˜¯æ’ä»¶åœ¨åº”ç”¨ä¸­å…è®¸è·³è½¬çš„ä»“åº“åœ°å€,è¯·æ”¾å…¥ç½‘ç»œé“¾æ¥  
type:`string`

### æ’ä»¶å›¾æ ‡

å¦‚æœæ˜¯æœ¬åœ°æ–‡ä»¶,è¯·ä»¥`ms-appx:///{ç›¸å¯¹ä½ç½®}`å¼€å¤´  
å¦‚æœæ˜¯FontIcon,è¯·ä»¥`font://{Glyph}`å¼€å¤´  
å¦‚æœæ˜¯FluentIcon,è¯·ä»¥`fluent://{Glyph}`å¼€å¤´  
type:`string`

### æ”¯æŒçš„æ’ä»¶ç®¡ç†å™¨ç‰ˆæœ¬

type:`int`

### æ”¯æŒçš„è¯­è¨€

type:`string[]`

### ä¾èµ–çš„æ’ä»¶ID

type:`string[]`
